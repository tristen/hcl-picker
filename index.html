<!DOCTYPE html>
<html>
  <head>
  <meta charset='utf-8' />
  <title>Colorpicker for Data</title>
  <link rel='shortcut icon' href='images/favicon.ico' type='image/x-icon' />
  <link rel='stylesheet' href='app.css' />
  <link href='http://tristen.ca/global.css' rel='stylesheet'>
	<script src='scripts/jquery.min.js'></script>
	<script src='scripts/jquery-ui.js'></script>
  <script src='scripts/chroma.js'></script>
  <script src='scripts/bootstrap-tooltip.js'></script>
  <script src='scripts/spin.min.js'></script>
  <script src='scripts/d3.js'></script>
  <script src='scripts/d3.geo.js'></script>
  <script src='app.js'></script>
</head>
<body>

 <div id='masthead'>
  <div class='limiter clearfix'>
    <div class='col4'>
      <div class='inner'>
        <h2>Tristen Brown</h2>
        <p>A Coder/Designer at <a href='http://mapbox.com'>MapBox.</a></p>
        <a href='http://tristen.ca' class='icon home' title='Homepage'>Home</a>
        <a href='http://twitter.com/fallsemo' class='icon twitter' title='Twitter'>Twitter</a>
        <a href='http://github.com/tristen' class='icon github' title='GitHub'>Github</a>
      </div>
    </div>
    <div class='col4'>
      <div class='inner'>
        <h3>Projects</h3>
        <ul>
          <li>
            <a href='http://tristen.ca/forsythe/'>Forsythe Sans</a>
            <p>A tall open type font.</p>
          </li>
          <li>
            <a href='http://tristen.ca/tablesort/demo/'>tablesort</a>
             <p>A dependency free sorting component for tables.</p>
          </li>
        </ul>
      </div>
    </div>
    <div class='col4'>
      <div class='inner'>
        <h3>&nbsp;</h3>
        <ul>
          <li>
            <a href='http://tristen.ca/hcl-picker/#/hlc/6/1/20313E/EFEE68'>HCL picker</a>
             <p>A hue, chroma, lightness color picker.</p>
          </li>
          <li>
            <a href='https://github.com/tristen/superman'>Superman</a>
             <p>A dark vim theme.</p>
          </li>
        </ul>
      </div>
    </div>
    <a href='#' id='t-toggle'><span>t</span></a>
  </div>
</div>

  <div class='heading'>
    <div class='limiter'>
      <h1>
        <span class='branding'>HCL</span>
        <span class='paraphrase'><a href='http://en.wikipedia.org/wiki/Munsell_color_system' class='acronym'>hue, chroma, lightness</a> colorpicker for data.</span>
        <small>Built off of Gregor Aisch's <a href='http://vis4.net/blog/posts/avoid-equidistant-hsv-colors'>demo</a> and color conversion library, <a href='https://github.com/gka/chroma.js'>chroma.js</a>. Map powered by <a href='http://d3js.org'>D3.js</a></small>
      </h1>
    </div>
  </div>

  <div id='modes' class='clearfix'>
    <div class='limiter'>
      <a href='#' class='icon' id='visualization-toggle' rel='tooltip' title='Visualize on a map'>&nbsp;</a>
    </div>
    <div id='color-picker' class='active section'>
      <div class='limiter clearfix'>
          <ul class='axis-select'></ul>
          <div class='canvas'>
            <div id='bg'>
              <canvas id='colorspace' width='210' height='210'></canvas>
            </div>
            <canvas id='grad' width='440' height='440'></canvas>
            <div class='drag_cont'>
              <div class='drag from'></div>
              <div class='drag to'></div>
            </div>
          </div>
          <div class='sidebar'>
            <div class='inner'>
              <div id='visual-output'></div>
              <div id='code-output'></div>
            </div>
            <div id='controls'>
              <a data-type='add' href='#' rel='tooltip' title='Add a swatch' >+</a>
              <a data-type='subtract' class='subtract' href='#' rel='tooltip' title='Remove a swatch'>-</a>
            </div>
          </div>
          <div class='slider'>
            <div id='sl-z' class='slider'></div>
            <div id='sl-val'></div>
          </div>
        </div>
      </div>
    <div id='visualization' class='section'></div>
    <div id='legend'>
      <h4>U.S Unemployment 2008</h4>
      <ul id='legend-output' class='clearfix'></ul>
      <div class='clearfix'>
        <span class='key high'>High</span>
        <span class='key low'>Low</span>
      </div>
    </div>
  <div id='load'></div>
  </div>
<script>
  $(document).ready(function() {
        var color = new Colorpicker;
        var path = d3.geo.path()
                  .projection(d3.geo.albersUsa()
                  .scale(960)
                  .translate([480, 265]));

        var svg = d3.select('#visualization')
                  .append('svg:svg')
                  .attr('width', 960)
                  .attr('height', 500);

        var counties = svg.append('svg:g').attr('id', 'counties');
        var pad = d3.format('05d');

        var chropleth = function() {
            d3.json('json/unemployment.json', function (data) {
                var quantize = d3.scale.quantile().domain(d3.values(data)).range(d3.range(color.colorArray.length));
                d3.json('json/us-counties.json', function (json) {
                    counties.selectAll('path').data(json.features).enter().append('svg:path').attr('style', function (d) {
                        return 'fill:' + color.colorArray[quantize(data[pad(d.id)])] + ';';
                    })
                    .attr('d', path).append('svg:title').text(function (d) {
                        return d.properties.name + ': ' + data[pad(d.id)] + '%';
                    });
                    loading('stop');
                });
            });
        }
        $('a[rel=tooltip]').tooltip({
              live: true
        });

        // Remove vis first.
        var vis = $('#visualization').detach(),
            picker;

        $('#visualization-toggle').toggle(function () {
              $('.tooltip').remove();
              $(this).addClass('active').attr('title', 'Back to colorpicker')
              picker = $('#color-picker').detach();
              $('#legend').addClass('active');
              vis.appendTo('#modes');
              vis = null;
              chropleth();
              loading('start');
          }, function() {
              loading('stop');
              $('#load').removeClass('active');
              $(this).removeClass('active').attr('title', 'Visualize on a map')
              vis = $('#visualization').detach();
              $('#legend').removeClass('active');
              picker.appendTo('#modes');
              picker = null;
              counties.selectAll('path').remove();
        });
    });
  </script>
<script src='http://tristen.ca/site.js'></script>
<script>
  var masthead = new Tristen();
  masthead.masthead();
</script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-15498769-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
